{"name":"71df5614-f85e-4a10-94a4-e3439d6936d8","id":"/providers/Microsoft.Flow/flows/71df5614-f85e-4a10-94a4-e3439d6936d8","type":"Microsoft.Flow/flows","properties":{"apiId":"/providers/Microsoft.PowerApps/apis/shared_logicflows","displayName":"Staff Check-ins Adhoc Schedules","definition":{"metadata":{"workflowEntityId":null,"creator":{"id":"e5d51810-90a7-4d30-bc9e-cdd66bced4f1","type":"User","tenantId":"efb8be03-af30-4722-8b7b-e9edaa03cf98"},"provisioningMethod":"FromDefinition","failureAlertSubscription":true,"clientLastModifiedTime":"2020-06-26T22:25:25.6612049Z"},"$schema":"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#","contentVersion":"1.0.0.0","parameters":{"$connections":{"defaultValue":{},"type":"Object"},"$authentication":{"defaultValue":{},"type":"SecureObject"}},"triggers":{"When_an_item_is_created_or_modified":{"recurrence":{"frequency":"Minute","interval":5},"splitOn":"@triggerBody()?['value']","metadata":{"flowSystemMetadata":{"swaggerOperationId":"GetOnUpdatedItems"}},"type":"ApiConnection","inputs":{"host":{"connection":{"name":"@parameters('$connections')['shared_sharepointonline_1']['connectionId']"},"api":{"runtimeUrl":"https://unitedstates-002.azure-apim.net/apim/sharepointonline"}},"method":"get","path":"/datasets/@{encodeURIComponent(encodeURIComponent('https://m365x699623.sharepoint.com/sites/SaffCheckinsFLW'))}/tables/@{encodeURIComponent(encodeURIComponent('Check-inSchedule'))}/onupdateditems","authentication":"@parameters('$authentication')"},"conditions":[{"expression":"@equals(triggerBody()?['CheckinType']?['value'],'Ad-hoc')"}]}},"actions":{"Post_your_own_adaptive_card_as_the_Flow_bot_to_a_channel":{"runAfter":{"Convert_time_zone":["Succeeded"]},"metadata":{"flowSystemMetadata":{"swaggerOperationId":"PostChannelAdaptiveCard"}},"type":"ApiConnection","inputs":{"host":{"connection":{"name":"@parameters('$connections')['shared_teams']['connectionId']"},"api":{"runtimeUrl":"https://unitedstates-002.azure-apim.net/apim/teams"}},"method":"post","body":{"recipient":{"channelId":"@triggerBody()?['ChannelId']"},"messageBody":"{\n    \"$schema\": \"http://adaptivecards.io/schemas/adaptive-card.json\",\n    \"type\": \"AdaptiveCard\",\n    \"version\": \"1.0\",\n    \"body\": [\n       {\n            \"type\": \"TextBlock\",\n            \"text\": \"Title: @{triggerBody()?['CheckInTitle']}\",\n            \"weight\": \"Bolder\",\n            \"size\": \"Large\",\n            \"wrap\":\"true\"\n        },\n        {\n            \"type\": \"TextBlock\",\n            \"text\": \"Note: @{triggerBody()?['ManagerNote']}\",\n            \"weight\": \"Default\",\n            \"size\": \"Medium\",\n            \"wrap\":\"true\"\n        },\n        {\n            \"type\": \"FactSet\",\n            \"facts\": [\n                {\n                    \"title\":    \"Team name:\",\n                    \"value\":   \"@{triggerBody()?['CheckinTeamName']}\"\n                },\n                {\n                    \"title\":    \"Check-in type:\",\n                    \"value\":   \"@{triggerBody()?['CheckInType']?['Value']}\"\n                }\n            ]\n        },\n\n       {\n            \"type\": \"TextBlock\",\n            \"text\": \"Please click on Check-in button to open the app and provide your check-in details. \",\n            \"weight\": \"Default\",\n            \"size\": \"Medium\",\n            \"wrap\":\"true\"\n        }\n    ],\n    \"actions\": [\n    {\n      \"type\": \"Action.OpenUrl\",\n      \"title\": \"Check-in\",\n      \"url\": \"https://apps.powerapps.com/play/c1d31bb3-bc13-4377-9583-86d38483b391?tenantId=b3cdf1c8-024a-49e2-a994-f67f830b02f3&DeepLink=Camera&TeamName=@{triggerBody()?['CheckinTeamName']}&CheckinTitle=@{triggerBody()?['CheckInTitle']}\"\n    }\n  ]\n}\n"},"path":"/flowbot/actions/adaptivecard/recipienttypes/channel","queries":{"groupId":"@triggerBody()?['TeamId']"},"authentication":"@parameters('$authentication')"}},"Convert_time_zone":{"runAfter":{},"type":"Expression","kind":"ConvertTimeZone","inputs":{"baseTime":"@triggerBody()?['Modified']","formatString":"MM/dd   HH:mm  tt","sourceTimeZone":"UTC","destinationTimeZone":"Pacific Standard Time"}}}},"connectionReferences":{"shared_teams":{"connectionName":"0dbe206a48d84211b367a8c175be43eb","source":"Embedded","id":"/providers/Microsoft.PowerApps/apis/shared_teams","tier":"NotSpecified"},"shared_sharepointonline_1":{"connectionName":"3650f1090dc94f108d90d07e1491bb58","source":"Embedded","id":"/providers/Microsoft.PowerApps/apis/shared_sharepointonline","tier":"NotSpecified"}},"flowFailureAlertSubscribed":false}}